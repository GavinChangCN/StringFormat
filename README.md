# 字符串格式化-字符转换符

### 前言
熟悉[C语言](http://lib.csdn.net/base/c)的同学应该记得C语言的**sprintf()**方法，它是通过在字符串中预先在需要替换的部位写入字符转换符，然后通过不定项对象的传值进行字符转换，而 Java 也有相似的方法**format()**进行字符转换，因为本人当前主要以 Java 语言进行开发工作，也出于对 Java 更为熟悉，所以接下来的博文主要以 Java 语言编写案例代码。

### 基础知识
#### Java 的 format()
方法format()有两种重载形式：
1. format(String format, Object... args) 新字符串使用本地语言环境，制定字符串格式和参数生成格式化的新字符串。
2. format(Locale locale, String format, Object... args) 使用指定的语言环境，制定字符串格式和参数生成格式化的字符串。
当然，最常使用**format()**方法的地方是**System.out**，那么一般的写法是***System.out.print(String.format("Hello %s", "World!"));***，代码既长也不优雅，所以语法糖的写法是***System.out.printf("Hello %s", "World!"));***

#### 字符转换符对应关系
|转换符|说    明|示    例|
|:---------|:-------------|:---------|
|%s|字符串类型|"NeFeed"|
|%c|字符类型|'m'|
|%b|布尔类型|true OR false|
|%d|整数类型（十进制）|10|
|%x|整数类型（十六进制）|FF|
|%o|整数类型（八进制）|77|
|%f|浮点类型|6.66|
|%a|十六进制浮点类型|E.4F|
|%e|指数类型|6.23e+24|
|%g|通用浮点类型（f和e类型中较短的）|42.5000 |
|%h|散列码|'A' -> 41|
|%%|百分比类型|％|
|%n|换行符|相当于"\n"换行作用|
|%tx|日期与时间类型（x代表不同的日期与时间转换符）|详见本博文的后半段|

#### 基础代码实战
测试用例(jUnit单元测试用例）：
```Java
@Test
public void stringFormatTest() {
	System.out.println(String.format("Hello %s", "World!"));
    System.out.println(String.format("Hi,%s、%s、%s", "Java", "Kolin", "Golang"));
    System.out.printf("字母a的大写是：%c %n", 'A');
    System.out.printf("10>1的结果是：%b %n", 10 > 1);
    System.out.printf("100的一半是：%d %n", 100 / 2);
    System.out.printf("100的16进制数是：%x %n", 100);
    System.out.printf("100的8进制数是：%o %n", 100);
    System.out.printf("50元的书打8.5折扣是：%f 元 %n", 50 * 0.85);
    System.out.printf("上面价格的16进制数是：%a %n", 50 * 0.85);
    System.out.printf("上面价格的指数表示：%e %n", 50 * 0.85);
    System.out.printf("上面价格的指数和浮点数结果的长度较短的是：%g %n", 50 * 0.85);
    System.out.printf("上面的折扣是%d%% %n", 85);
    System.out.printf("字母A的散列码是：%h %n", 'A');
}
```
控制台输出结果：
```Console
Hello World!
Hi,Java、Kolin、Golang
字母a的大写是：A 
10>1的结果是：true 
100的一半是：50 
100的16进制数是：64 
100的8进制数是：144 
50元的书打8.5折扣是：42.500000 元
上面价格的16进制数是：0x1.54p5 
上面价格的指数表示：4.250000e+01 
上面价格的指数和浮点数结果的长度较短的是：42.5000 
上面的折扣是85% 
字母A的散列码是：41 
```
### 进阶知识
#### 进阶标识基础转换符表
|标    志|说    明|示    例|结    果|
|:---------|:-------------|:--------|:--------|
|+|为正数或者负数添加符号|("%+d",15)|+15|
|−|左对齐|("n%-5dn",25)|n25   n|
|0|数字前面补0|("%04d", 21)|0021|
|空格|在整数之前添加指定数量的空格|("n% 4dn", 99)|n    99n|
|,|以“,”对数字分组（英式数字计数法）|("%,f", 9999.99)|9,999.990000|
|(|使用括号包含负数|("%(f", -99.99)|(99.990000)|
|#|如果是浮点数则包含小数点，如果是16进制或8进制则添加0x或0|("%#x", 99)<br />("%#o", 99)|0x63<br />0143|
|< |格式化前一个转换符所描述的参数|("%f", 99.45)<br />("%<3.2f", 99.45)|99.450000<br />99.45|
|$|被格式化的参数索引|("%1$d,%2$s", 99,"abc")|99,abc|

#### 进阶代码实战
测试用例(jUnit单元测试用例）：
```Java
@Test
public void advanceStringFormatTest() {
    // + 使用
    System.out.printf("显示正负数的符号：%+d与%d %n", 10, -10);
    // - 使用
    System.out.printf("显示左对齐的符号：n%-5dn%-6dn %n", 25, -32);
    // O 使用
    System.out.printf("编号是：%04d %n", 21);
    // 空格 使用
    System.out.printf("Tab键的效果是：% 4d %n", 7);
    // , 使用
    System.out.printf("整数分组的效果是：%,d %n", 9989997);
    // ( 使用
    System.out.printf("使用括号包含负数的效果是：%(f", -88.88);
    // # 使用
    System.out.printf("#x的效果是：%#x，#o的效果是：%#o %n", 99, 99);
    // < 使用
    System.out.printf("格式化前一个转换符所描述的参数:%f ; %<3.2f %n", 99.45, 99.45);
    // $ 使用
    System.out.println(String.format("格式参数$的使用：%1$d,%2$s", 99, "abc"));
    // 空格和小数点后面个数
    System.out.printf("一本书的价格是：% 5.5f元%n", 49.8);
}
```
 控制台输出结果：
```Console
显示正负数的符号：+10与-10 
显示左对齐的符号：n25   n-32   n 
编号是：0021 
Tab键的效果是：   7 
整数分组的效果是：9,989,997 
使用括号包含负数的效果是：(88.880000)#x的效果是：0x63，#o的效果是：0143 
格式化前一个转换符所描述的参数:99.450000 ; 99.45 
格式参数$的使用：99,abc
一本书的价格是： 49.80000元
```

### 日期和事件字符串格式化
在程序界面中经常需要显示时间和日期，但是其显示的格式在各个界面和业务需求中又是大相径庭，需要编写大量的代码经过各种[算法](http://lib.csdn.net/base/datastructure)才得到适用的日期与时间格式。字符串格式中还有%tx转换符没有详细介绍，它是专门用来格式化日期和时间的。%tx转换符中的x代表另外的处理日期和时间格式的转换符，它们的组合能够将日期和时间格式化成多种格式。

####  常见日期和时间转换符表
|转换符|说    明|示    例|
|:---------|:-------------|:---------|
|%tc|包括完整的日期和时间信息|星期五 四月 21 14:21:20 CST 2017|
|%tF|“年-月-日”格式|2017-04-21|
|%tD|“月/日/年”格式|04/21/17|
|%tr|“HH:MM:SS PM”格式（12时制）|02:25:51 下午|
|%tT|“HH:MM:SS”格式（24时制）|14:28:16|
|%tR|“HH:MM”格式（24时制）|14:28|

#### 日期代码实战
测试用例(jUnit单元测试用例）：
```Java
@Test
public void dateAndTimeFormatTest() {
    Date date = new Date();
    // c 的使用
    System.out.printf("完整的日期和时间信息：%tc%n", date);
    // f 的使用
    System.out.printf("年-月-日格式：%tF%n", date);
    // d 的使用
    System.out.printf("月/日/年格式：%tD%n", date);
    // r 的使用
    System.out.printf("HH:MM:SS PM格式（12时制）：%tr%n", date);
    // t 的使用
    System.out.printf("HH:MM:SS格式（24时制）：%tT%n", date);
    // R 的使用
    System.out.printf("HH:MM格式（24时制）：%tR", date);
}
```
控制台输出结果：
```Console
完整的日期和时间信息：星期五 四月 21 14:47:00 CST 2017
年-月-日格式：2017-04-21
月/日/年格式：04/21/17
HH:MM:SS PM格式（12时制）：02:47:00 下午
HH:MM:SS格式（24时制）：14:47:00
HH:MM格式（24时制）：14:47
```

####  进阶日期转换符表
|转换符|说    明|示    例|
|:---------|:-------------|:---------|
|%tb|月份简称|Apr<br />四月|
|%tB|英文月份全称|April<br /> 四月 |
|%ta|星期的简称|Fri<br />星期五|
|%tA|星期的全称|Friday<br /> 星期五 |
|%tC|年数的前两位数字（不足两位前面补0）|20|
|%ty|年数的后两位数字（不足两位前面补0）|17|
|%tj|今年已经过去的天数|111|
|%tm|两位数字的月份（不足两位前面补0）|04|
|%td|两位数字的日（不足两位前面补0）|21|
|%te|月份的日（前面不补0）|21|

#### 进阶日期代码实战
```Java
@Test
public void advanceDateFormatTest() {
    Date date=new Date();
    // b 的使用，月份简称
    String str=String.format(Locale.US,"英文月份简称：%tb",date);
    System.out.println(str);
    System.out.printf("本机语言环境的月份简称：%tb%n",date);
    // B 的使用，月份全称
    str=String.format(Locale.US,"英文月份全称：%tB",date);
    System.out.println(str);
    System.out.printf("本机语言环境的月份全称：%tB%n",date);
    // a 的使用，星期简称
    str=String.format(Locale.US,"英文星期的简称：%ta",date);
    System.out.println(str);
    System.out.printf("本机语言环境的星期的简称：%ta%n",date);
    // A 的使用，星期全称
    str=String.format(Locale.US,"英文星期的全称：%tA",date);
    System.out.println(str);
    System.out.printf("本机语言环境的星期的全称：%tA%n",date);
    // C 的使用，年数的前两位数字（不足两位前面补0）
    System.out.printf("年的前两位数字（不足两位前面补0）：%tC%n",date);
    // y 的使用，年数的后两位数字（不足两位前面补0）
    System.out.printf("年的后两位数字（不足两位前面补0）：%ty%n",date);
    // j 的使用，今年已经过去的天数
    System.out.printf("今年已经过去的天数：%tj%n",date);
    // m 的使用，月份
    System.out.printf("两位数字的月份（不足两位前面补0）：%tm%n",date);
    // d 的使用，日（二位，不够补零）
    System.out.printf("两位数字的日（不足两位前面补0）：%td%n",date);
    // e 的使用，日（一位不补零）
    System.out.printf("月份的日（前面不补0）：%te",date);
}
```
控制台输出结果：
```Console
英文月份简称：Apr
本机语言环境的月份简称：四月
英文月份全称：April
本机语言环境的月份全称：四月
英文星期的简称：Fri
本机语言环境的星期的简称：星期五
英文星期的全称：Friday
本机语言环境的星期的全称：星期五
年的前两位数字（不足两位前面补0）：20
年的后两位数字（不足两位前面补0）：17
一年中的天数（即年的第几天）：111
两位数字的月份（不足两位前面补0）：04
两位数字的日（不足两位前面补0）：21
月份的日（前面不补0）：21
```

####  进阶时间转换符表
|转换符|说    明|示    例|
|:---------|:-------------|:---------|
|%tH|2位数字24时制的小时（不足2位前面补0）|15|
|%tI|2位数字12时制的小时（不足2位前面补0）|03 |
|%tk|2位数字24时制的小时（前面不补0）|15|
|%tl|2位数字12时制的小时（前面不补0）|3 |
|%tM|2位数字的分钟（不足2位前面补0）|20|
|%tS|2位数字的秒（不足2位前面补0）|12|
|%tL|3位数字的毫秒（不足3位前面补0）|381|
|%tN|9位数字的毫秒数（不足9位前面补0）| 381000000 |
|%tp|小写字母的上午或下午标记|中：下午<br />英：pm|
|%tz|相对于GMT的RFC822时区的偏移量|+0800|
|%tZ|时区缩写字符串| CST |
|%ts|1970-1-1 00:00:00 到现在所经过的秒数| 1492759212 |
|%tQ|1970-1-1 00:00:00 到现在所经过的毫秒数| 1492759212381 |
#### 进阶时间代码实战
```Java
@Test
public void advanceTimeFormatTest() {
    Date date = new Date();
    //H的使用
    System.out.printf("2位数字24时制的小时（不足2位前面补0）:%tH%n", date);
    //I的使用
    System.out.printf("2位数字12时制的小时（不足2位前面补0）:%tI%n", date);
    //k的使用
    System.out.printf("2位数字24时制的小时（前面不补0）:%tk%n", date);
    //l的使用
    System.out.printf("2位数字12时制的小时（前面不补0）:%tl%n", date);
    //M的使用
    System.out.printf("2位数字的分钟（不足2位前面补0）:%tM%n", date);
    //S的使用
    System.out.printf("2位数字的秒（不足2位前面补0）:%tS%n", date);
    //L的使用
    System.out.printf("3位数字的毫秒（不足3位前面补0）:%tL%n", date);
    //N的使用
    System.out.printf("9位数字的毫秒数（不足9位前面补0）:%tN%n", date);
    //p的使用
    String str = String.format(Locale.US, "小写字母的上午或下午标记(英)：%tp", date);
    System.out.println(str);
    System.out.printf("小写字母的上午或下午标记（中）：%tp%n", date);
    //z的使用
    System.out.printf("相对于GMT的RFC822时区的偏移量:%tz%n", date);
    //Z的使用
    System.out.printf("时区缩写字符串:%tZ%n", date);
    //s的使用
    System.out.printf("1970-1-1 00:00:00 到现在所经过的秒数：%ts%n", date);
    //Q的使用
    System.out.printf("1970-1-1 00:00:00 到现在所经过的毫秒数：%tQ%n", date);
}
```
控制台输出结果：
```Console
2位数字24时制的小时（不足2位前面补0）:15
2位数字12时制的小时（不足2位前面补0）:03
2位数字24时制的小时（前面不补0）:15
2位数字12时制的小时（前面不补0）:3
2位数字的分钟（不足2位前面补0）:20
2位数字的秒（不足2位前面补0）:12
3位数字的毫秒（不足3位前面补0）:381
9位数字的毫秒数（不足9位前面补0）:381000000
小写字母的上午或下午标记(英)：pm
小写字母的上午或下午标记（中）：下午
相对于GMT的RFC822时区的偏移量:+0800
时区缩写字符串:CST
1970-1-1 00:00:00 到现在所经过的秒数：1492759212
1970-1-1 00:00:00 到现在所经过的毫秒数：1492759212381
```

### 总结
字符串格式化-字符转换符是一把利刃，用得好，可以减少大量的代码量，但是，阅读本文并编写测试代码的同学肯定也发现了，字符转换符实在是种类太多了，靠死记硬背肯定是不行的，大家可以收藏这篇博文以作字典使用，而个别常用的字符转换符，大家可以牢记于心。